{"version":3,"sources":["mobile.js"],"names":["window","session","xd_phone","checkLogin_second","cts2","cts","location","$","click","length","set","Date","getTime","attr","val","setProgressMax","xd_progressMax","checkSec","setTimeout","is","xd_check","get","phone","xd_user_info","data","name","household_address","contactNum","registration_time","inNetDate","xdProcessData","spiderData2","eq","startSpiderMonthData","fixMonthValue","month","str","log","obj","Object","total","get_current_page_bill","pushCallDetailData","xd_page1","xd_page","substring","indexOf","text","xd_page2","index","nextIndex","jQuery","arr","page_total","Array","i","wrapCall","find","xd_data","xd_callBill","monthData","xd_cid","zfill","time","s","substr","size","status","value","push","call","showMask","showProgress","isShow","maskDiv","css","opacity","position","top","left","background-color","width","height","title1","append","inputPwd","inputPwdTop","title1Left","font-size","title2","offset","title2Top","inputSms","inputSmsTop","input","settime","errorMessage","color","certificateBtn","certificateBtnAction","show","hide","alert","test","xd_pwd","che_vertify_dismiss","countdown","removeAttribute","setAttribute","xd_month_progress_count","spiderData","removeAttr","xd_sec_vertify_dis","setStartUrl"],"mappings":"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","file":"../mobile.js","sourcesContent":["dSpider(\"mobile\",function(session,env,$) {\n\n    checkLogin_first();\n\n    // -------------------------------------------\n    function checkLogin_first() {\n\n        var xd_phone = session.get(\"xd_phone\");\n        window.xd_phone = xd_phone;\n        if (window.xd_phone) {\n            session.autoLoadImg(false)\n            checkLogin_second();\n            return;\n        }\n\n        var cts = 'login.10086.cn';\n        var cts2 = 'channelID';\n        if (window.location.href.indexOf(cts) >= 0 && window.location.href.indexOf(cts2) >= 0) {\n\n            if ($('#getSMSpwd').length) {\n                $('#getSMSpwd').click(function () {\n                    session.set(\"firstSMSTime\",new Date().getTime() + '');\n                });\n            }\n\n            if ($('#getPhoneSMSpwd').length) {\n                $('#getPhoneSMSpwd').click(function () {\n                    session.set(\"firstSMSTime\",new Date().getTime() + '');\n                });\n            }\n\n            $('#submit_bt').click(function () {\n\n                //存储手机号\n                if ($('#account_nav').attr('class') == 'on') {\n                    session.set(\"xd_phone\",$('#p_phone_account').val());\n                } else {\n                    session.set(\"xd_phone\",$('#p_phone').val());\n                }\n\n                if ($('#p_sms').val() == '') {\n                    session.set(\"firstSMSTime\",'0');\n                }\n            });\n        }\n    }\n\n    function checkLogin_second() {\n\n        //手机号和密码未就绪的\n        if (!window.xd_phone) return;\n        var cts = 'shop.10086.cn/i/?f=billdetailqry&welcome=';\n        if (window.location.href.indexOf(cts) >= 0) {\n            var phone = window.xd_phone;\n            //检测是否需要登陆短信\n            session.showProgress();\n            session.setProgressMax(7);\n            window.xd_progressMax = 1;\n            session.setProgress(window.xd_progressMax);\n            window.xd_data = new Object();\n            window.xd_month_progress_count = 0;\n\n            setTimeout(function() {\n                checkSec();\n            },5000);\n        }\n    }\n\n    function checkSec() {\n        if ($('.all-site-loading div').is(':visible')) {\n            location.reload();\n            return;\n        }\n\n        //检测是否需要二次验证\n        xd_check();\n    }\n\n    function getMyUserInfo(phone) {\n\n        var url = 'http://shop.10086.cn/i/v1/cust/info/' + phone + '?time=' + new Date().getTime();\n        $.get(url, function (result) {\n\n            var data = result.data;\n\n            var xd_user_info = {\n                'mobile':window.xd_phone,\n                'name': data.name,\n                'household_address': data.address,\n                'contactNum': data.contactNum,\n                'registration_time': data.inNetDate,\n            };\n\n            window.xd_data['user_info'] = xd_user_info;\n            window.xd_progressMax++;\n            session.setProgress(window.xd_progressMax);\n            window.xd_month_progress_count++;\n            xdProcessData();\n        });\n    }\n\n    function spiderData() {\n\n        //爬取用户信息\n        getMyUserInfo(window.xd_phone);\n\n        //爬取用户通话详单\n        spiderData2();\n    }\n\n    function spiderData2()  {\n        $('#switch-data li').eq(1).click();\n        $('#month-data li').eq(0).click();\n\n        setTimeout(function() {\n            if ($('#switch-data li').eq(1).attr('class') == 'active') {\n                startSpiderMonthData(0, 1);\n            } else {\n                spiderData2();\n            }\n        }, 3000);\n    }\n\n    function startSpiderMonthData(month, index) {\n\n        // alert('' + month + '月 ' + index);\n\n        var fixMonthValue = (function fixMonthValue(month) {\n            var str = month;\n            str=str.replace(\"年\",\"\");\n            str=str.replace(\"月\",\"\");\n            return str;\n        })($('#month-data li').eq(month).text());\n\n        //有详单记录\n        if ($('#tbody').is(':visible')) {\n            log('有详单记录');\n            //此月爬完push\n            var obj = new Object();\n            obj['month'] = fixMonthValue;\n            obj['value'] = get_current_page_bill();\n            var total = $('#notes2').text();\n            obj['total'] = total.substring(1, total.length - 1);\n            pushCallDetailData(obj);\n\n            var xd_page = $('#notes1').text().substring(1, $('#notes1').text().length - 1);\n            var xd_page1 = xd_page.substring(0, xd_page.indexOf('/'));\n            var xd_page2 = xd_page.substring(xd_page.indexOf('/') + 1);\n            if (xd_page1 == xd_page2) {\n                log('当前是最后一页');\n                window.xd_progressMax++;\n                session.setProgress(window.xd_progressMax);\n                month++;\n                if (month > 5) {\n                    window.xd_month_progress_count++;\n                    xdProcessData();\n                    return;\n                }\n                $('#month-data li').eq(month).click();\n                setTimeout(function () {\n                    startSpiderMonthData(month, index);\n                }, 3000);\n            } else {\n                var nextIndex = parseInt(xd_page1);\n                nextIndex++;\n                window.jQuery(\".gs-page\").eq(nextIndex - 1).click();\n                setTimeout(function () {\n                    startSpiderMonthData(month, nextIndex);\n                }, 4000);\n            }\n            return;\n        }\n\n        //您选择时间段没有详单记录哦\n        if ($('tbody.err tr td:eq(0) div:eq(0) div:eq(1) div:eq(0)').is(':visible')) {\n            log('选择时间段没有详单记录');\n            //此月爬完push\n            var obj = new Object();\n            obj['month'] = fixMonthValue;\n            obj['value'] = new Array();\n            obj['total'] = 0;\n            pushCallDetailData(obj);\n            window.xd_progressMax = window.xd_progressMax + month + 1;\n            session.setProgress(window.xd_progressMax);\n            month++;\n            if (month > 5) {\n                window.xd_month_progress_count++;\n                xdProcessData();\n                return;\n            }\n            $('#month-data li').eq(month).click();\n            setTimeout(function () {\n                startSpiderMonthData(month, index);\n            }, 3000);\n            return;\n        }\n\n        //还没出来，网络较差\n        if ($('a.gs-search').is(':visible')) {\n            window.jQuery(\".gs-page\").eq(index - 1).click();\n        } else {\n            $('#month-data li').eq(month).click();\n        }\n        setTimeout(function () {\n            startSpiderMonthData(month, index);\n        }, 6000);\n    }\n\n    function get_current_page_bill() {\n        var arr = new Array();\n        var page_total = $('#tbody tr').length;\n        for (var i = 0; i < page_total; i++) {\n            var wrapCall = new Object();\n            wrapCall['callFee'] = $('#tbody tr').eq(i).find('td').eq(7).text();\n            wrapCall['remoteType'] = $('#tbody tr').eq(i).find('td').eq(5).text();\n            wrapCall['callType'] = $('#tbody tr').eq(i).find('td').eq(2).text();\n            wrapCall['callTime'] = $('#tbody tr').eq(i).find('td').eq(4).text();\n            wrapCall['callAddress'] = $('#tbody tr').eq(i).find('td').eq(1).text();\n            wrapCall['callBeginTime'] = $('#tbody tr').eq(i).find('td').eq(0).text();\n            wrapCall['otherNo'] = $('#tbody tr').eq(i).find('td').eq(3).text();\n            wrapCall['taocan'] = $('#tbody tr').eq(i).find('td').eq(6).text();\n            arr.push(wrapCall);\n        }\n        return arr;\n    }\n\n    //整理详单数据\n    function xdProcessData() {\n        if (window.xd_month_progress_count == 2) {\n            window.xd_data['month_status'] = window.xd_callBill;\n            session.upload(window.xd_data);\n            session.finish();\n        }\n    }\n\n    //存储详单数据\n    function pushCallDetailData(data) {\n\n        if (!window.xd_callBill) {\n            window.xd_callBill = new Array();\n        }\n\n        var monthData = null;\n        if (window.xd_callBill.length > 0) {\n            //查看是不是已经有此月份了\n            for (var i = 0; i < window.xd_callBill.length; i++) {\n                var obj = window.xd_callBill[i];\n                if (obj.calldate.indexOf(data.month) >= 0) {\n                    //有此月份\n                    monthData = obj;\n                    break;\n                }\n            }\n        }\n\n        //第一次添加月份\n        if (monthData == null) {\n\n            var time = new Date().getTime();\n            var xd_cid = (function zfill(num, size) {\n                var s = \"000000000\" + num;\n                return s.substr(s.length - size);\n            }(time, 10));\n\n            monthData = new Object();\n            monthData['data'] = new Array();\n            monthData['calldate'] = data.month;\n            monthData['totalCount'] = data.total;\n            monthData['mobile'] = window.xd_phone;\n            monthData['cid'] = xd_cid;\n            monthData['status'] = 4;\n            window.xd_callBill.push(monthData);\n        }\n\n        if (data.status){\n            monthData['status'] = data.status;\n        }\n\n        if (data.value.length > 0) {\n            for (var i = 0; i < data.value.length; i++) {\n                var call = data.value[i];\n                monthData.data.push(call);\n            }\n        }\n    }\n\n    function xd_check() {\n        $('#month-data li').eq(0).click();\n        setTimeout(function() {\n            if ($('#show_vec_firstdiv').is(':visible')) {\n                showMask(true);\n                $('#sendSmsBtn').click(function () {\n                    $('#stc-send-sms').click();\n                });\n                return;\n            }\n            xd_check();\n        }, 6000);\n    }\n\n    function showMask(isShow) {\n\n        if (!isShow) {\n            session.showProgress();\n        } else {\n            session.showProgress(false);\n        }\n\n        if (isShow) {\n            if ($('#maskDiv').length == 0) {\n                var maskDiv = $('<div></div>');        //创建一个父div\n                maskDiv.attr('id', 'maskDiv');        //给父div设置id\n                $(\"body\").append(maskDiv);\n                $(\"#maskDiv\").css({\n                    'opacity': 1,\n                    'position': 'absolute',\n                    'top': 0,\n                    'left': 0,\n                    'background-color': '#f0f1f3',\n                    'width': '150%',\n                    'height': '150%',\n                    'z-index': 214748364,\n                });\n\n                //提示1\n                var title1 = $($('<p><p/>'));\n                title1.text('请输入服务密码：');\n                $(\"#maskDiv\").append(title1);\n                title1.css({\n                    'position': 'absolute',\n                    'left': '30px',\n                    'top': '50px',\n                    'height': '60px',\n                    'width': '300px',\n                    'font-size': '30px',\n                });\n\n                //密码输入框\n                var inputPwd = $('<input type=\"text\" id=\"inputPwd\"/>');\n                $(\"#maskDiv\").append(inputPwd);\n\n                var title1Left = title1.offset().left + 'px';\n                var inputPwdTop = title1.offset().top + title1.height() + 10 + 'px';\n                $('#inputPwd').css({\n                    'position': 'absolute',\n                    'left': title1Left,\n                    'top': inputPwdTop,\n                    'height': '60px',\n                    'width': '300px',\n                    'font-size': '20x',\n                    'background-color': 'white',\n                });\n\n                //提示2\n                var title2 = $($('<p><p/>'));\n                title2.text('请输入短信验证码：');\n                $(\"#maskDiv\").append(title2);\n\n                var title2Top = $('#inputPwd').offset().top + $('#inputPwd').height() + 50 + 'px';\n                title2.css({\n                    'position': 'absolute',\n                    'left': title1Left,\n                    'top': title2Top,\n                    'height': '60px',\n                    'width': '300px',\n                    'font-size': '30px',\n                });\n\n                //短信输入框\n                var inputSms = $('<input type=\"text\" id=\"inputSms\"/>');\n                $(\"#maskDiv\").append(inputSms);\n\n                var inputSmsTop = title2.offset().top + title2.height() + 10 + 'px';\n                $('#inputSms').css({\n                    'position': 'absolute',\n                    'left': title1Left,\n                    'top': inputSmsTop,\n                    'height': '60px',\n                    'width': '180px',\n                    'font-size': '30px',\n                    'background-color': 'white',\n                });\n\n                //发送短信\n                var input = $('<input type=\"button\" id=\"sendSmsBtn\" value=\"获取短信\"/>');\n                input.click(settime);\n                $(\"#maskDiv\").append(input);\n\n                $('#sendSmsBtn').css({\n                    'position': 'absolute',\n                    'left': $('#inputSms').offset().left + $('#inputSms').width() + 25 + 'px',\n                    'top': $('#inputSms').offset().top + 10 + 'px',\n                    'height': '40px',\n                    'width': '120px',\n                    'font-size': '20px',\n                    'background-color':\"#5a7bd0\",\n                });\n\n                //错误提示\n                var errorMessage = $($('<p id=\"xd_sec_errorMessage\"><p/>'));\n                $(\"#maskDiv\").append(errorMessage);\n                $('#xd_sec_errorMessage').css({\n                    'position': 'absolute',\n                    'left': title1Left,\n                    'top': $('#inputSms').offset().top + $('#inputSms').height() + 12 + 'px',\n                    'height': '40px',\n                    'width': '300px',\n                    'font-size': '20px',\n                    'color': 'red',\n                });\n\n                //认证\n                var certificateBtn = $('<input type=\"button\" id=\"certificateBtn\" value=\"去认证\"/>');\n                certificateBtn.click(certificateBtnAction);\n                $(\"#maskDiv\").append(certificateBtn);\n\n                $('#certificateBtn').css({\n                    'position': 'absolute',\n                    'left': title1Left,\n                    'top': $('#inputSms').offset().top + $('#inputSms').height() + 50 + 'px',\n                    'height': '60px',\n                    'width': '300px',\n                    'font-size': '30px',\n                    'color': 'white',\n                    'background-color':'#fe6246',\n                });\n\n\n            } else {\n                $('#maskDiv').show();\n            }\n        } else {\n            if ($('#maskDiv').lensgth != 0) {\n                $('#maskDiv').hide();\n            }\n        }\n    }\n\n    function certificateBtnAction() {\n        window.xd_pwd = $('#inputPwd').val();\n\n        if (!/^\\d{6}$/.test(window.xd_pwd)) {\n            alert('请输入6位服务密码！');\n            return;\n        }\n\n        if (!/^\\d{6}$/.test($('#inputSms').val())) {\n            alert('请输入6位短信验证码！');\n            return;\n        }\n\n        //服务密码\n        $('#vec_servpasswd').val('' + window.xd_pwd);\n        // 随机密码\n        $('#vec_smspasswd').val('' + $('#inputSms').val());\n\n        $('#vecbtn').click();\n\n        $('#certificateBtn').attr({\"disabled\":true});\n\n        setTimeout(function () {\n            che_vertify_dismiss();\n        }, 3000);\n    }\n\n    window.countdown = 60;\n    function settime() {\n\n        var obj = $('#sendSmsBtn')[0];\n        if (window.countdown == 0) {\n            obj.removeAttribute(\"disabled\");\n            obj.value = \"获取短信验证码\";\n            window.countdown = 60;\n            return;\n        } else {\n            window.xd_pwd = $('#inputPwd').val();\n            obj.setAttribute(\"disabled\", true);\n            obj.value = \"重新发送(\" + window.countdown + \")\";\n            window.countdown--;\n        }\n        setTimeout(function () {\n                settime();\n            }\n            , 1000);\n    }\n\n    window.xd_sec_vertify_dis = 0;\n    function che_vertify_dismiss() {\n        window.xd_sec_vertify_dis++;\n        if (!$('#show_vec_firstdiv').is(':visible') && $('tbody').length > 0) {\n            showMask();\n            $('#switch-data li').eq(1).click();\n            $('#month-data li').eq(0).click();\n            setTimeout(function () {\n                window.xd_month_progress_count = 0;\n                spiderData();\n            }, 3000);\n            return;\n        }\n\n        if ($('#detailerrmsg').is(':visible')) {\n            //认证失败,提示错误信息\n            var errorMessage = $('#detailerrmsg').text();\n            $('#xd_sec_errorMessage').text(errorMessage);\n            $('#certificateBtn').removeAttr(\"disabled\");\n\n        } else {\n            if (window.xd_sec_vertify_dis == 6) {\n                window.xd_sec_vertify_dis = 0;\n                $('#certificateBtn').removeAttr(\"disabled\");\n                return;\n            }\n            setTimeout(function() {che_vertify_dismiss();}, 3000);\n        }\n    }\n\n    //设置当前页是登陆页\n    if ($('#forget_btn').length && $('#forget_btn').length > 0) {\n        session.setStartUrl();\n    }\n});"]}