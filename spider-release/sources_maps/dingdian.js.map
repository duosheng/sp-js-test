{"version":3,"sources":["dingdian.js"],"names":["sessionKey","dQuery","text","dSpider","session","env","$","location","href","indexOf","css","test","list","curIndex","getText","e","eq","get","attr","done","data","find","upload","always","length","setProgress","setProgressMsg","log","finish","showProgress","setProgressMax"],"mappings":";;AAAA;;;AAGA,IAAIA,aAAWC,OAAO,iBAAP,EAA0BC,IAA1B,EAAf;AACAC,QAAQH,UAAR,EAAoB,UAASI,OAAT,EAAiBC,GAAjB,EAAqBC,CAArB,EAAuB;AACvC,QAAGC,SAASC,IAAT,CAAcC,OAAd,CAAsB,QAAtB,KAAiC,CAAC,CAArC,EAAuC;AACnCH,UAAE,SAAF,EAAaJ,IAAb,CAAkB,MAAlB,EAA0BQ,GAA1B,CAA8B,YAA9B,EAA2C,SAA3C;AACH,KAFD,MAEM,IAAG,sBAAsBC,IAAtB,CAA2BJ,SAASC,IAApC,CAAH,EAA8C;AAAA,YAE5CI,IAF4C;AAAA,YAK5CC,QAL4C;;AAAA;AAAA,gBAOvCC,OAPuC,GAOhD,SAASA,OAAT,GAAmB;AACf,oBAAIC,IAAIH,KAAKI,EAAL,CAAQH,QAAR,CAAR;AACAP,kBAAEW,GAAF,CAAMF,EAAEG,IAAF,CAAO,MAAP,CAAN,EAAsBC,IAAtB,CAA2B,UAAUC,IAAV,EAAgB;AACvC,wBAAIlB,OAAOa,EAAEb,IAAF,KAAW,MAAtB;AACAA,4BAAQI,EAAEc,IAAF,EAAQC,IAAR,CAAa,MAAb,EAAqBnB,IAArB,KAA4B,MAApC;AACAE,4BAAQkB,MAAR,CAAepB,IAAf;AAEH,iBALD,EAKGqB,MALH,CAKU,YAAY;AAClB,wBAAI,EAAEV,QAAF,GAAaD,KAAKY,MAAtB,EAA8B;AAC1BpB,gCAAQqB,WAAR,CAAoBZ,QAApB;AACAT,gCAAQsB,cAAR,CAAuB,UAAQ1B,UAAR,GAAmB,IAAnB,GAAwBe,EAAEb,IAAF,EAA/C;AACAY;AACAa,4BAAId,QAAJ,EAAcD,KAAKY,MAAnB;AACH,qBALD,MAKO;AACHpB,gCAAQqB,WAAR,CAAoBZ,QAApB;AACAT,gCAAQwB,MAAR;AACH;AACJ,iBAfD;AAgBH,aAzB+C;;AAChDD,gBAAI3B,UAAJ;AACIY,mBAAON,EAAE,eAAF,CAFqC;;AAGhDF,oBAAQyB,YAAR;AACAzB,oBAAQ0B,cAAR,CAAuBlB,KAAKY,MAA5B;AACIX,uBAAW,CALiC;;AA0BhDC;AA1BgD;AA2BnD;AACJ,CA/BD","file":"../dingdian.js","sourcesContent":["/**\n * Created by du on 16/11/21.\n */\nvar sessionKey=dQuery(\".index_block h1\").text()\ndSpider(sessionKey, function(session,env,$){\n    if(location.href.indexOf(\"/book/\")!=-1){\n        $(\".more a\").text(\"爬取本书\").css(\"background\",\"#1ca72b\");\n    }else if(/.+html\\/\\d+\\/\\d+\\/$/.test(location.href)) {\n        log(sessionKey)\n        var list = $(\".chapter li a\");\n        session.showProgress();\n        session.setProgressMax(list.length);\n        var curIndex = 0\n\n        function getText() {\n            var e = list.eq(curIndex);\n            $.get(e.attr(\"href\")).done(function (data) {\n                var text = e.text() + \"\\r\\n\";\n                text += $(data).find(\"#txt\").text()+\"\\r\\n\"\n                session.upload(text)\n\n            }).always(function () {\n                if (++curIndex < list.length) {\n                    session.setProgress(curIndex);\n                    session.setProgressMsg(\"正在爬取《\"+sessionKey+\"》 \"+e.text())\n                    getText();\n                    log(curIndex, list.length)\n                } else {\n                    session.setProgress(curIndex);\n                    session.finish();\n                }\n            })\n        }\n        getText()\n    }\n})\n"]}