{"version":3,"sources":["telecom_gd.js"],"names":["dSpider","log","location","env","$","each","month","find","console","curMonthIndex","this","attr","param","months","stringify","d.d01","loadXdByMonth","end","SearchVerifyCode","val","trim","dataType","type","success","result","r06","current_page","commuTypeIndex","phoneIndex","r05","dateIndex","i","durationIndex","indexOf","feeIndex","callTypeIndex","locationIndex","data","total_page","detail","setProgress","details","datas","parseInt","Date","getTime","toString","session","length","start","JSON","setXd","sessionStorage","setTimeout","setItem","pathname","href","encodeURIComponent","search","alert","r","showMask","msg","err","textStatus","readyState","complete","thxd","get","getLoginUserType","beforeSend","b","c","loginUser","payType","r04","r14","showErr","error","lantId","d.d02","phone","d.d03","showProgress","isShow","maskDiv","append","css","opacity","position","top","title2","width","height","z-index","text","inputSms","title1Left","font-size","inputSmsTop","left","offset","sendSms","background-color","click","getSmsCode","latnId","account","certificateBtn","certificateBtnAction","hide","window","loadXd","obj","value","countdown","settime","setAttribute","userInfo","timeout","t","ob","clearInterval","set","waitDomAvailable","address","dom","timeSpan"],"mappings":"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","file":"../telecom_gd.js","sourcesContent":["log(\"****************Debug model *******************\")\ndSpider(\"telecom_gd\", function(session,env,$){\n    log(\"current page: \"+location.href)\n\n\n    if(location.href.indexOf(\"SSOLoginForCommNoPage\") != -1) {\n        console.log(\"SSOLoginForCommNoPage\");\n        return;\n    } else if(location.href.indexOf(\"http://gd.189.cn/TS/index.htm\") != -1 || location.href.indexOf(\"gd.189.cn/TS/?SESSIONID=\") != -1) {\n\n        session.showProgress();\n        session.setProgress(0);\n        var thxd = session.get(\"thxd\")\n        if(!thxd) {\n            thxd = {};\n        }\n        var userInfo = thxd[\"user_info\"];\n        if(!userInfo) {\n            userInfo = {};\n        }\n        if(!userInfo[\"name\"]) {\n            var timeout = 10000;\n            var t = setInterval(function () {\n                timeout -= 10;\n                var ob = $(\"#user_name\")\n                if (ob[0] && ob.text() != \"--\") {\n                    session.setProgress(10);\n                    clearInterval(t)\n                    userInfo[\"name\"] = ob.text();\n                    console.log(JSON.stringify(userInfo));\n                    thxd[\"user_info\"] = userInfo;\n                    session.set(\"thxd\", thxd);\n                    location.href = \"http://gd.189.cn/transaction/taocanapply1.jsp?operCode=ChangeCustInfoNew\";\n                } else if (timeout == 0) {\n                    session.setProgress(10);\n                    clearInterval(t);\n                    location.href = \"http://gd.189.cn/transaction/taocanapply1.jsp?operCode=ChangeCustInfoNew\";\n                }\n            }, 10);\n        }\n    } else if (location.href.indexOf(\"gd.189.cn/OperationInitAction2.do?OperCode=ChangeCustInfoNew\") != -1) {\n\n        waitDomAvailable(\"#cust_name_id\", function(dom,timeSpan) {\n            session.setProgress(20);\n            log(\"wait cust_name_id success\");\n            var thxd = session.get(\"thxd\")\n            if(!thxd) {\n                thxd = {};\n            }\n            var userInfo = thxd[\"user_info\"];\n            if(!userInfo) {\n                userInfo = {};\n            }\n            if(!userInfo[\"name\"]) {\n                userInfo[\"name\"]=$(\"#cust_name_id\").val();\n            }\n\n            userInfo[\"idcard_no\"]=$(\"#id_num_id\").val();\n            userInfo[\"contactNum\"]=$(\"#moblie_id\").val();\n            var address = $(\"#post_addr_id\").val();\n            if(address.length == 0) {\n                address = $(\"#id_addr_id\").val();\n            }\n            userInfo[\"household_address\"] = address;\n\n            thxd[\"user_info\"] = userInfo;\n            session.set(\"thxd\", thxd);\n\n            location.href = \"http://gd.189.cn/TS/cx/puk_chaxun.htm?cssid=wdwt-xgcx-puk_pincx\";\n            console.log(JSON.stringify(userInfo));\n        },function() {\n            log(\"wait cust_name_id fail\");\n        });\n\n\n    } else if (location.href.indexOf(\"gd.189.cn/TS/cx/puk_chaxun.htm?cssid=wdwt-xgcx-puk_pincx\") != -1) {\n\n        waitDomAvailable(\"#phone\", function(dom,timeSpan) {\n            session.setProgress(30);\n            log(\"wait custName success\");\n            var thxd = session.get(\"thxd\")\n            if(!thxd) {\n                thxd = {};\n            }\n            var userInfo = thxd[\"user_info\"];\n            if(!userInfo) {\n                userInfo = {};\n            }\n\n            userInfo[\"mobile\"]=$(\"#phone\").text();\n\n            thxd[\"user_info\"] = userInfo;\n            session.set(\"thxd\", thxd);\n            console.log(JSON.stringify(userInfo));\n//                location.href=\"http://gd.189.cn/TS/wode-wangting-sec.htm?cssid=sy-dh-top-wdwt\";\n            location.href=\"http://gd.189.cn/TS/cx/xiangdan_chaxun.htm?cssid=sy-kscx-xdcx\";\n        },function() {\n            log(\"wait phone fail\");\n        });\n\n    } else if (location.href.indexOf(\"gd.189.cn/TS/cx/xiangdan_chaxun.htm?cssid=sy-kscx-xdcx\") != -1) {\n        waitDomAvailable(\".get_sms_code\", function(dom,timeSpan) {\n            session.setProgress(40);\n            getLoginUserType(function () {\n                // showMask(true);\n            })\n        },function() {\n            log(\"wait phone fail\");\n        });\n\n    }\n\n\n    var months = [];\n    var curMonthIndex = 0;\n    var phoneIndex = -1;\n    var dateIndex = -1;\n    var durationIndex = -1;\n    var feeIndex = -1;\n    var callTypeIndex = -1;\n    var locationIndex = -1;\n    var commuTypeIndex = -1;\n\n\n    var details=[];\n    var datas=[];\n    var param={};\n\n    var loginUser={};\n\n    function loadXd() {\n\n        $.each($(\".rq_list\").find(\"li\"), function () {\n            var month = {};\n            month[\"month\"] = $(this).attr(\"data-month\");\n            month[\"start\"] = $(this).attr(\"data-start\");\n            month[\"end\"] = $(this).attr(\"data-end\");\n            months.push(month);\n        });\n        console.log(JSON.stringify(months));\n        curMonthIndex = 0;\n\n        param={\"d.d01\":\"\",\"d.d02\":\"\",\"d.d03\":\"\",\"d.d04\":\"\",\"d.d05\":\"20\",\"d.d06\":\"1\",\"d.d07\":\"\",\"d.d08\":\"1\"};\n        param[\"d.d06\"]=1;\n        param[\"d.d01\"]=\"call\";\n        // param[\"d.d02\"]=$(\".rq_list_on\").attr(\"data-month\");\n        // param[\"d.d03\"]=$(\".rq_list_on\").attr(\"data-start\");\n        // param[\"d.d04\"]=$(\".rq_list_on\").attr(\"data-end\");\n        param[\"d.d02\"]=months[curMonthIndex].month;\n        param[\"d.d03\"]=months[curMonthIndex].start;\n        param[\"d.d04\"]=months[curMonthIndex].end;\n        var SearchVerifyCode=$(\"#input_code\").val().trim();\n        param[\"d.d07\"]=SearchVerifyCode;\n\n\n        loadXdByMonth();\n    }\n\n    function loadXdByMonth() {\n        $.ajax({\n            url:\"/J/J10009.j?a.c=0&a.u=user&a.p=pass&a.s=ECSS\",\n            type:'get',\n            dataType:\"json\",\n            data:param,\n            beforeSend:function(){\n                console.log(\"beforeSend\");\n                console.log(param);\n            },\n            success:function(result){\n                console.log(param);\n                console.log(result);\n                if(result&&result.b&&result.b.c===\"00\"){//查询成功\n                    switch(result.r.code){\n                        case \"000\":\n                        case \"009\":\n                            result=result.r||result;\n                            var current_page=result.r06;\n                            var total_page=result.r05;\n                            current_page==1&&$.each(result.r02,function(i){\n                                if(this.indexOf(\"通话类型\") != -1) {\n                                    commuTypeIndex = i;\n                                } else if(this.indexOf(\"号码\") != -1) {\n                                    phoneIndex = i;\n                                } else if(this.indexOf(\"日期\") != -1) {\n                                    dateIndex = i;\n                                } else if(this.indexOf(\"时长\") != -1) {\n                                    durationIndex = i;\n                                } else if(this.indexOf(\"费用\") != -1) {\n                                    feeIndex = i;\n                                } else if(this.indexOf(\"呼叫类型\") != -1) {\n                                    callTypeIndex = i;\n                                } else if(this.indexOf(\"通话地\") != -1) {\n                                    locationIndex = i;\n                                }\n                            });\n                            $.each(result.r03,function(){\n                                var data = {}\n                                $.each(this, function (i) {\n                                    var s = this + \"\";\n                                    if (i == commuTypeIndex) {\n                                        data[\"remoteType\"] = s;\n                                    } else if (i == phoneIndex) {\n                                        data[\"otherNo\"] = s;\n                                    } else if (i == dateIndex) {\n                                        data[\"callBeginTime\"] = s;\n                                    } else if (i == durationIndex) {\n                                        data[\"callTime\"] = s;\n                                    } else if (i == feeIndex) {\n                                        data[\"callFee\"] = s;\n                                    } else if (i == callTypeIndex) {\n                                        data[\"callType\"] = s;\n                                    } else if (i == locationIndex) {\n                                        data[\"callAddress\"] = s;\n                                    }\n                                });\n                                datas.push(data);\n                            });\n\n                            if(total_page>current_page) {\n                                param[\"d.d06\"]=parseInt(param[\"d.d06\"])+1;\n                                session.setProgress(45+(55/months.length)*(curMonthIndex+current_page/total_page));\n                                loadXdByMonth();\n                            } else {\n                                console.log(\"load success:\" + months[curMonthIndex].month);\n                                var detail = {};\n                                detail[\"calldate\"] = months[curMonthIndex].month;\n                                detail[\"cid\"] = parseInt(new Date().getTime()/1000).toString();\n                                detail[\"data\"] = datas;\n                                detail[\"status\"] = 4;\n                                details.push(detail);\n                                // console.log(JSON.stringify(datas)||'<tr><td class=\"empty\">'+(result.msg||\"暂无数据\")+'</td></tr>');\n                                datas = [];\n                                if(curMonthIndex < months.length-1) {\n                                    session.setProgress(45+55*(curMonthIndex+1)/months.length);\n                                    curMonthIndex++;\n                                    param[\"d.d02\"]=months[curMonthIndex].month;\n                                    param[\"d.d03\"]=months[curMonthIndex].start;\n                                    param[\"d.d04\"]=months[curMonthIndex].end;\n                                    param[\"d.d06\"]=1;\n                                    console.log(\"curMonthIndex:\" + curMonthIndex + \"|\" + months[curMonthIndex].month);\n                                    loadXdByMonth();\n                                } else {\n                                    console.log(\"details\");\n                                    console.log(JSON.stringify(details));\n                                    setXd(details);\n                                }\n                            }\n                            break;\n                        case \"001\"://未登录\n                            sessionStorage.setItem(\"gd_TS_login_url\",location.pathname);\n                            setTimeout(function(){\n                                location.href=\"https://gd.189.cn/TS/login.htm?redir=\"+encodeURIComponent(location.pathname+location.search)\n                            },1500);\n                        default://其它\n                            console.log(result.r.msg);\n                            if(result.r.msg.indexOf(\"验证码\") != -1) {\n                                alert(result.r.msg);\n                                showMask(true);\n                            }\n                    }\n                }else{\n                    alert(\"清单查询初始化，请重试！\");\n                    console.log(\"load fail:\" + months[curMonthIndex].month);\n                    var detail = {};\n                    detail[\"calldate\"] = months[curMonthIndex].month;\n                    detail[\"cid\"] = parseInt(new Date().getTime()/1000).toString();\n                    detail[\"data\"] = datas;\n                    if(datas.length > 0) {\n                        detail[\"status\"] = 5;\n                    } else {\n                        detail[\"status\"] = 2;\n                    }\n                    details.push(detail);\n                    // console.log(JSON.stringify(datas)||'<tr><td class=\"empty\">'+(result.msg||\"暂无数据\")+'</td></tr>');\n                    datas = [];\n                    if(curMonthIndex < months.length-1) {\n                        session.setProgress(45+55*(curMonthIndex+1)/months.length);\n                        curMonthIndex++;\n                        param[\"d.d02\"]=months[curMonthIndex].month;\n                        param[\"d.d03\"]=months[curMonthIndex].start;\n                        param[\"d.d04\"]=months[curMonthIndex].end;\n                        param[\"d.d06\"]=1;\n                        console.log(\"curMonthIndex:\" + curMonthIndex + \"|\" + months[curMonthIndex].month);\n                        loadXdByMonth();\n                    } else {\n                        console.log(\"details\");\n                        console.log(JSON.stringify(details));\n                        setXd(details);\n                    }\n                }\n            },\n            error:function(err,textStatus){\n                console.log(\"ajax请求失败!readyState:\"+err.readyState+\",textStatus:\"+textStatus);\n                alert(\"清单查询初始化，请重试！\");\n\n                console.log(\"load error:\" + months[curMonthIndex].month);\n                var detail = {};\n                detail[\"calldate\"] = months[curMonthIndex].month;\n                detail[\"cid\"] = parseInt(new Date().getTime()/1000).toString();\n                detail[\"data\"] = datas;\n                if(datas.length > 0) {\n                    detail[\"status\"] = 5;\n                } else {\n                    detail[\"status\"] = 2;\n                }\n                details.push(detail);\n                // console.log(JSON.stringify(datas)||'<tr><td class=\"empty\">'+(result.msg||\"暂无数据\")+'</td></tr>');\n                datas = [];\n                if(curMonthIndex < months.length-1) {\n                    session.setProgress(45+55*(curMonthIndex+1)/months.length);\n                    curMonthIndex++;\n                    param[\"d.d02\"]=months[curMonthIndex].month;\n                    param[\"d.d03\"]=months[curMonthIndex].start;\n                    param[\"d.d04\"]=months[curMonthIndex].end;\n                    param[\"d.d06\"]=1;\n                    console.log(\"curMonthIndex:\" + curMonthIndex + \"|\" + months[curMonthIndex].month);\n                    loadXdByMonth();\n                } else {\n                    console.log(\"details\");\n                    console.log(JSON.stringify(details));\n                    setXd(details);\n                }\n            },\n            complete:function(){\n                console.log(\"complete\");\n            }\n        });\n    }\n\n    function setXd(xd) {\n        var thxd = session.get(\"thxd\")\n        if(!thxd) {\n            thxd = {};\n        }\n        thxd[\"month_status\"] = xd;\n        session.set(\"thxd\", thxd);\n\n        session.setProgress(100);\n\n        log(\"爬取完毕----------\" + JSON.stringify(thxd));\n        session.upload(JSON.stringify(thxd));\n        session.finish();\n    }\n\n\n    function getLoginUserType(callback){\n        $.ajax({\n            url:\"/J/J10036.j?a.c=0&a.u=user&a.p=pass&a.s=ECSS\",\n            type:'get',\n            dataType:\"json\",\n            data:{},\n            beforeSend:function(){\n            },\n            success:function(result){\n                if(result&&result.b&&result.b.c===\"00\"){//查询成功\n                    switch(result.r.code){\n                        case \"000\":\n                            var r=result.r,_numStr;\n                            loginUser.account= r.r03||r.r02;//当前号码\n                            loginUser.currNumBusiType = r.r05||r.r04;//当前号码业务类型\n                            loginUser.payType = r.r07;//付费类型\n                            loginUser.latnId= r.r14;//区号\n                            session.setProgress(45);\n                            // callback();\n                            console.log(JSON.stringify(loginUser));\n                            // getSmsCode(loginUser.latnId,loginUser.account);\n                            showMask(true);\n                            break;\n                        case \"001\"://未登录\n                        default://其它\n                            showErr(result.r.msg);\n                    }\n                }else{\n                    console.log(\"详单查询初始化失败，请重试！\");\n                }\n            },\n            error:function(err,textStatus){\n                console.log(\"ajax请求失败!readyState:\"+err.readyState+\",textStatus:\"+textStatus);\n            },\n            complete:function(){\n            }\n        });\n    }\n\n    /**\n     * 获得短信验证码\n     * @param lantId\n     * @param phone\n     */\n    function getSmsCode(lantId,phone){\n        $.ajax({\n            url:\"/J/J20009.j?a.c=0&a.u=user&a.p=pass&a.s=ECSS\",\n            type:'post',\n            dataType:\"json\",\n            data:{\"d.d01\":lantId,\"d.d02\":phone,\"d.d03\":\"CDMA\"},\n            success:function(result){\n                if(result&&result.b&&result.b.c===\"00\"){//查询成功\n                    var r=result.r;\n                    if(r.code===\"000\"){\n                        settime();\n                        console.log(\"短信验证码已经发送，请查收！\");\n                        alert(\"短信验证码已经发送，请查收！\");\n                    }else{\n                        console.log(msg);\n                        alert(msg);\n                    }\n                }else{\n                    console.log(\"短信验证码已经发送失败，请重试！\");\n                    alert(\"短信验证码已经发送失败，请重试！\");\n                }\n\n            },\n            error:function(err,textStatus){\n                console.log(\"ajax请求失败!readyState:\"+err.readyState+\",textStatus:\"+textStatus);\n            }\n        });\n    }\n\n\n\n\n    function showMask(isShow) {\n\n        if (!isShow) {\n            session.showProgress();\n        } else {\n            session.showProgress(false);\n\n        }\n\n        if (isShow) {\n            if ($('#maskDiv').length == 0) {\n                var maskDiv = $('<div></div>');        //创建一个父div\n                maskDiv.attr('id', 'maskDiv');        //给父div设置id\n                $(\"body\").append(maskDiv);\n                $(\"#maskDiv\").css({\n                    'opacity': 1,\n                    'position': 'absolute',\n                    'top': 0,\n                    'left': 0,\n                    'background-color': '#AAAAAA',\n                    'width': '200%',\n                    'height': '200%',\n                    'z-index': 10000\n                });\n\n                //提示2\n                var title2 = $($('<p><p/>'));\n                title2.text('请输入短信验证码：');\n                $(\"#maskDiv\").append(title2);\n\n                title2.css({\n                    'position': 'absolute',\n                    'left': '30px',\n                    'top': '200px',\n                    'height': '60px',\n                    'width': '300px',\n                    'font-size': '30px',\n                });\n\n                //短信输入框\n                var inputSms = $('<input type=\"text\" id=\"inputSms\"/>');\n                $(\"#maskDiv\").append(inputSms);\n\n                var title1Left = title2.offset().left + 'px';\n                var inputSmsTop = title2.offset().top + title2.height() + 10 + 'px';\n                $('#inputSms').css({\n                    'position': 'absolute',\n                    'left': title1Left,\n                    'top': inputSmsTop,\n                    'height': '60px',\n                    'width': '300px',\n                    'font-size': '30px',\n                    'background-color': 'yellow',\n                });\n\n                //发送短信\n                var sendSms = $('<input type=\"button\" id=\"sendSmsBtn\" value=\"免费获取验证码\"/>').click(getSmsCode(loginUser.latnId,loginUser.account));\n                $(\"#maskDiv\").append(sendSms);\n\n                $('#sendSmsBtn').css({\n                    'position': 'absolute',\n                    'left': $('#inputSms').offset().left + $('#inputSms').width() + 30 + 'px',\n                    'top': $('#inputSms').offset().top + 'px',\n                    'height': '60px',\n                    'width': '200px',\n                    'font-size': '30px',\n                    'background-color': 'green',\n                });\n\n                //认证\n                var certificateBtn = $('<input type=\"button\" id=\"certificateBtn\" value=\"去认证\"/>').click(certificateBtnAction);\n                $(\"#maskDiv\").append(certificateBtn);\n\n                $('#certificateBtn').css({\n                    'position': 'absolute',\n                    'left': title1Left,\n                    'top': $('#inputSms').offset().top + $('#inputSms').height() + 50 + 'px',\n                    'height': '60px',\n                    'width': '300px',\n                    'font-size': '30px',\n                    'background-color': 'green',\n                });\n\n            } else {\n                $('#maskDiv').show();\n            }\n        } else {\n            if ($('#maskDiv').lensgth != 0) {\n                $('#maskDiv').hide();\n            }\n        }\n    }\n\n    function certificateBtnAction() {\n        window.xd_pwd = $('#inputPwd').val();\n\n        if (!/^\\d{6}$/.test($('#inputSms').val())) {\n            alert('请输入6位短信验证码！');\n            return;\n        }\n\n        showMask(false);\n\n        $(\"#input_code\").val($('#inputSms').val());\n\n        loadXd();\n        // verify_second_sms($('#inputSms').val());\n    }\n\n    window.countdown = 60;\n    function settime() {\n\n        var obj = $('#sendSmsBtn')[0];\n        if (window.countdown == 0) {\n            obj.removeAttribute(\"disabled\");\n            obj.value = \"免费获取验证码\";\n            window.countdown = 60;\n            return;\n        } else {\n            window.xd_pwd = $('#inputPwd').val();\n            obj.setAttribute(\"disabled\", true);\n            obj.value = \"重新发送(\" + window.countdown + \")\";\n            window.countdown--;\n        }\n        setTimeout(function () {\n                settime()\n            }\n            , 1000);\n    }\n\n})"]}