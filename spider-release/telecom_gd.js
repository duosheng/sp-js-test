!function t(e,o,n){function s(i,r){if(!o[i]){if(!e[i]){var d="function"==typeof require&&require;if(!r&&d)return d(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=o[i]={exports:{}};e[i][0].call(c.exports,function(t){var o=e[i][1][t];return s(o?o:t)},c,c.exports,t,e,o,n)}return o[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)s(n[i]);return s}({1:[function(t,e,o){"use strict";log("****************Debug model *******************"),dSpider("telecom_gd",function(t,e,o){function n(){o.each(o(".rq_list").find("li"),function(){var t={};t.month=o(this).attr("data-month"),t.start=o(this).attr("data-start"),t.end=o(this).attr("data-end"),h.push(t)}),console.log(JSON.stringify(h)),m=0,T={"d.d01":"","d.d02":"","d.d03":"","d.d04":"","d.d05":"20","d.d06":"1","d.d07":"","d.d08":"1"},T["d.d06"]=1,T["d.d01"]="call",T["d.d02"]=h[m].month,T["d.d03"]=h[m].start,T["d.d04"]=h[m].end;var t=o("#input_code").val().trim();T["d.d07"]=t,s()}function s(){o.ajax({url:"/J/J10009.j?a.c=0&a.u=user&a.p=pass&a.s=ECSS",type:"get",dataType:"json",data:T,beforeSend:function(){console.log("beforeSend"),console.log(T)},success:function(e){if(console.log(T),console.log(e),e&&e.b&&"00"===e.b.c)switch(e.r.code){case"000":case"009":e=e.r||e;var n=e.r06,i=e.r05;if(1==n&&o.each(e.r02,function(t){this.indexOf("通话类型")!=-1?b=t:this.indexOf("号码")!=-1?x=t:this.indexOf("日期")!=-1?v=t:this.indexOf("时长")!=-1?S=t:this.indexOf("费用")!=-1?w=t:this.indexOf("呼叫类型")!=-1?_=t:this.indexOf("通话地")!=-1&&(y=t)}),o.each(e.r03,function(){var t={};o.each(this,function(e){var o=this+"";e==b?t.remoteType=o:e==x?t.otherNo=o:e==v?t.callBeginTime=o:e==S?t.callTime=o:e==w?t.callFee=o:e==_?t.callType=o:e==y&&(t.callAddress=o)}),k.push(t)}),i>n)T["d.d06"]=parseInt(T["d.d06"])+1,t.setProgress(45+55/h.length*(m+n/i)),s();else{console.log("load success:"+h[m].month);var r={};r.calldate=h[m].month,r.cid=parseInt((new Date).getTime()/1e3).toString(),r.data=k,r.status=4,O.push(r),k=[],m<h.length-1?(t.setProgress(45+55*(m+1)/h.length),m++,T["d.d02"]=h[m].month,T["d.d03"]=h[m].start,T["d.d04"]=h[m].end,T["d.d06"]=1,console.log("curMonthIndex:"+m+"|"+h[m].month),s()):(console.log("details"),console.log(JSON.stringify(O)),a(O))}break;case"001":sessionStorage.setItem("gd_TS_login_url",location.pathname),setTimeout(function(){location.href="https://gd.189.cn/TS/login.htm?redir="+encodeURIComponent(location.pathname+location.search)},1500);default:console.log(e.r.msg),e.r.msg.indexOf("验证码")!=-1&&(alert(e.r.msg),d(!0))}else{alert("清单查询初始化，请重试！"),console.log("load fail:"+h[m].month);var r={};r.calldate=h[m].month,r.cid=parseInt((new Date).getTime()/1e3).toString(),r.data=k,k.length>0?r.status=5:r.status=2,O.push(r),k=[],m<h.length-1?(t.setProgress(45+55*(m+1)/h.length),m++,T["d.d02"]=h[m].month,T["d.d03"]=h[m].start,T["d.d04"]=h[m].end,T["d.d06"]=1,console.log("curMonthIndex:"+m+"|"+h[m].month),s()):(console.log("details"),console.log(JSON.stringify(O)),a(O))}},error:function(e,o){console.log("ajax请求失败!readyState:"+e.readyState+",textStatus:"+o),alert("清单查询初始化，请重试！"),console.log("load error:"+h[m].month);var n={};n.calldate=h[m].month,n.cid=parseInt((new Date).getTime()/1e3).toString(),n.data=k,k.length>0?n.status=5:n.status=2,O.push(n),k=[],m<h.length-1?(t.setProgress(45+55*(m+1)/h.length),m++,T["d.d02"]=h[m].month,T["d.d03"]=h[m].start,T["d.d04"]=h[m].end,T["d.d06"]=1,console.log("curMonthIndex:"+m+"|"+h[m].month),s()):(console.log("details"),console.log(JSON.stringify(O)),a(O))},complete:function(){console.log("complete")}})}function a(e){var o=t.get("thxd");o||(o={}),o.month_status=e,t.set("thxd",o),t.setProgress(100),log("爬取完毕----------"+JSON.stringify(o)),t.upload(JSON.stringify(o)),t.finish()}function i(e){o.ajax({url:"/J/J10036.j?a.c=0&a.u=user&a.p=pass&a.s=ECSS",type:"get",dataType:"json",data:{},beforeSend:function(){},success:function(e){if(e&&e.b&&"00"===e.b.c)switch(e.r.code){case"000":var o=e.r;I.account=o.r03||o.r02,I.currNumBusiType=o.r05||o.r04,I.payType=o.r07,I.latnId=o.r14,t.setProgress(45),console.log(JSON.stringify(I)),d(!0);break;case"001":default:showErr(e.r.msg)}else console.log("详单查询初始化失败，请重试！")},error:function(t,e){console.log("ajax请求失败!readyState:"+t.readyState+",textStatus:"+e)},complete:function(){}})}function r(t,e){o.ajax({url:"/J/J20009.j?a.c=0&a.u=user&a.p=pass&a.s=ECSS",type:"post",dataType:"json",data:{"d.d01":t,"d.d02":e,"d.d03":"CDMA"},success:function(t){if(t&&t.b&&"00"===t.b.c){var e=t.r;"000"===e.code?(l(),console.log("短信验证码已经发送，请查收！"),alert("短信验证码已经发送，请查收！")):(console.log(msg),alert(msg))}else console.log("短信验证码已经发送失败，请重试！"),alert("短信验证码已经发送失败，请重试！")},error:function(t,e){console.log("ajax请求失败!readyState:"+t.readyState+",textStatus:"+e)}})}function d(e){if(e?t.showProgress(!1):t.showProgress(),e)if(0==o("#maskDiv").length){var n=o("<div></div>");n.attr("id","maskDiv"),o("body").append(n),o("#maskDiv").css({opacity:1,position:"absolute",top:0,left:0,"background-color":"#AAAAAA",width:"200%",height:"200%","z-index":1e4});var s=o(o("<p><p/>"));s.text("请输入短信验证码："),o("#maskDiv").append(s),s.css({position:"absolute",left:"30px",top:"200px",height:"60px",width:"300px","font-size":"30px"});var a=o('<input type="text" id="inputSms"/>');o("#maskDiv").append(a);var i=s.offset().left+"px",d=s.offset().top+s.height()+10+"px";o("#inputSms").css({position:"absolute",left:i,top:d,height:"60px",width:"300px","font-size":"30px","background-color":"yellow"});var l=o('<input type="button" id="sendSmsBtn" value="免费获取验证码"/>').click(r(I.latnId,I.account));o("#maskDiv").append(l),o("#sendSmsBtn").css({position:"absolute",left:o("#inputSms").offset().left+o("#inputSms").width()+30+"px",top:o("#inputSms").offset().top+"px",height:"60px",width:"200px","font-size":"30px","background-color":"green"});var u=o('<input type="button" id="certificateBtn" value="去认证"/>').click(c);o("#maskDiv").append(u),o("#certificateBtn").css({position:"absolute",left:i,top:o("#inputSms").offset().top+o("#inputSms").height()+50+"px",height:"60px",width:"300px","font-size":"30px","background-color":"green"})}else o("#maskDiv").show();else 0!=o("#maskDiv").lensgth&&o("#maskDiv").hide()}function c(){return window.xd_pwd=o("#inputPwd").val(),/^\d{6}$/.test(o("#inputSms").val())?(d(!1),o("#input_code").val(o("#inputSms").val()),void n()):void alert("请输入6位短信验证码！")}function l(){var t=o("#sendSmsBtn")[0];return 0==window.countdown?(t.removeAttribute("disabled"),t.value="免费获取验证码",void(window.countdown=60)):(window.xd_pwd=o("#inputPwd").val(),t.setAttribute("disabled",!0),t.value="重新发送("+window.countdown+")",window.countdown--,void setTimeout(function(){l()},1e3))}if(log("current page: "+location.href),location.href.indexOf("SSOLoginForCommNoPage")!=-1)return void console.log("SSOLoginForCommNoPage");if(location.href.indexOf("http://gd.189.cn/TS/index.htm")!=-1||location.href.indexOf("gd.189.cn/TS/?SESSIONID=")!=-1){t.showProgress(),t.setProgress(0);var u=t.get("thxd");u||(u={});var g=u.user_info;if(g||(g={}),!g.name)var f=1e4,p=setInterval(function(){f-=10;var e=o("#user_name");e[0]&&"--"!=e.text()?(t.setProgress(10),clearInterval(p),g.name=e.text(),console.log(JSON.stringify(g)),u.user_info=g,t.set("thxd",u),location.href="http://gd.189.cn/transaction/taocanapply1.jsp?operCode=ChangeCustInfoNew"):0==f&&(t.setProgress(10),clearInterval(p),location.href="http://gd.189.cn/transaction/taocanapply1.jsp?operCode=ChangeCustInfoNew")},10)}else location.href.indexOf("gd.189.cn/OperationInitAction2.do?OperCode=ChangeCustInfoNew")!=-1?waitDomAvailable("#cust_name_id",function(e,n){t.setProgress(20),log("wait cust_name_id success");var s=t.get("thxd");s||(s={});var a=s.user_info;a||(a={}),a.name||(a.name=o("#cust_name_id").val()),a.idcard_no=o("#id_num_id").val(),a.contactNum=o("#moblie_id").val();var i=o("#post_addr_id").val();0==i.length&&(i=o("#id_addr_id").val()),a.household_address=i,s.user_info=a,t.set("thxd",s),location.href="http://gd.189.cn/TS/cx/puk_chaxun.htm?cssid=wdwt-xgcx-puk_pincx",console.log(JSON.stringify(a))},function(){log("wait cust_name_id fail")}):location.href.indexOf("gd.189.cn/TS/cx/puk_chaxun.htm?cssid=wdwt-xgcx-puk_pincx")!=-1?waitDomAvailable("#phone",function(e,n){t.setProgress(30),log("wait custName success");var s=t.get("thxd");s||(s={});var a=s.user_info;a||(a={}),a.mobile=o("#phone").text(),s.user_info=a,t.set("thxd",s),console.log(JSON.stringify(a)),location.href="http://gd.189.cn/TS/cx/xiangdan_chaxun.htm?cssid=sy-kscx-xdcx"},function(){log("wait phone fail")}):location.href.indexOf("gd.189.cn/TS/cx/xiangdan_chaxun.htm?cssid=sy-kscx-xdcx")!=-1&&waitDomAvailable(".get_sms_code",function(e,o){t.setProgress(40),i(function(){})},function(){log("wait phone fail")});var h=[],m=0,x=-1,v=-1,S=-1,w=-1,_=-1,y=-1,b=-1,O=[],k=[],T={},I={};window.countdown=60})},{}]},{},[1]);
//# sourceMappingURL=sources_maps/telecom_gd.js.map
